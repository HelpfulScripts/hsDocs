(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{10:function(t,e,a){"use strict";function s(t,e,a,s){const n=s(t),r="function"==typeof e,o="object"==typeof e&&void 0!==e.length;return isNaN(n)?(console.log(`column name '${t}' cannot be resolved in terminal condition ${t}=${e}`),console.log(a),!1):r?e(a[n],a):o?0===e.length||e.some(t=>a[n]===t):a[n]===e}a.r(e);class n{constructor(t){this.data=[],this.meta=[],this.import(t)}static toDataSet(t,e){t=t||[{}];const a=Object.keys(t[0]);return{rows:t.map(t=>a.map(e=>t[e])),colNames:a,name:e||void 0}}getName(){return this.name}import(t){this.name=t.name,this.setData(t.rows,t.colNames)}export(){return{rows:this.getData(),colNames:this.colNames()}}getData(){return this.data}getColumn(t){const e=this.colNumber(t);return this.data.map(t=>t[e])}colAdd(t){let e=this.getMeta(t);return void 0===e&&((e=this.meta[t]={}).name=t,e.column=this.meta.length,this.meta.push(e),e.cast=!1,e.accessed=!1),e.column}colInitialize(t,e){const a=this.colNumber(t);a||"string"!=typeof t||this.colAdd(t);const s="function"==typeof e;void 0!==a&&this.data.map((t,n)=>t[a]=s?e(t[a],n,t):e)}colNumber(t){const e=this.getMeta(t);return e?(e.accessed=!0,e.column):void 0}colName(t){var e=this.getMeta(t);if(e)return e.accessed=!0,e.name}colNames(){return this.meta.map(t=>t.name)}colType(t){const e=this.getMeta(t);return e?e.types[0].type:n.type.name}findDomain(t,e){if(void 0===e&&(e=[]),void 0===t)e[0]=0,e[1]=this.data.length-1;else{const a=this.colNumber(t),s=this.colType(t);switch(void 0===this.data&&console.log("no data"),s){case n.type.name:this.data.forEach(t=>{const s=e;s.indexOf(""+t[a])<0&&s.push(""+t[a])});break;default:this.data.forEach(t=>{let s=t[a];void 0===e[0]&&(e[0]=s),void 0===e[1]&&(e[1]=s),void 0!==s&&null!==s&&(s<e[0]?e[0]=s:s>e[1]&&(e[1]=s))})}}return e}castData(){this.meta.forEach(t=>{const e=t.column;t.cast||this.data.forEach(a=>a[e]=this.castVal(t.types[0].type,a[e])),t.cast=!0})}filter(t){return function(t,e){const a=e=>t.colNumber(e);try{return new n({name:t.getName(),colNames:t.colNames(),rows:t.getData().filter((t,n)=>(function t(e,a,n,r,o){let i=!1,c=!0;if(void 0===e)return!0;if("number"==typeof e)return e===n;if("object"!=typeof e)return console.error(`unrecognized condition: ${JSON.stringify(e)}`),!1;{const l=e;if(void 0!==l.length)return void 0===o&&(o=!1),0!==l.length&&(o?l.every(e=>t(e,a,n,r,o)):l.some(e=>t(e,a,n,r,o)));void 0===o&&(o=!0);for(const l in e){let u=o;const h=e;switch(l){case"or":u=t(h.or,a,n,r,!1);break;case"and":u=t(h.and,a,n,r,!0);break;case"not":u=!t(h.not,a,n,r);break;default:u=s(l,e[l],a,r)}if(u){if(i=!0,!o)break}else if(c=!1,o)break}}return o?c:i})(e,t,n,a))})}catch(t){console.log(t),console.log(t.stack)}}(this,t)}sort(t,e){let a=t;return e?(e=this.colNumber(e),"descending"===t&&(a=((t,e)=>e>t?1:e<t?-1:0)),"ascending"===t&&(a=((t,e)=>e<t?1:e>t?-1:0)),this.data.sort((t,s)=>a(t[e],s[e]))):this.data.sort(a),this}map(t,e){const a=t=>t;let s=new n({colNames:this.colNames(),rows:this.data.slice(),name:this.getName()});return(t.length?t:[t]).map(t=>{const n=this.colNumber(t);let r=function(){let t;switch(e){case"cumulate":t=(()=>{let t=0;return(e,a)=>t+=+e})();break;case"noop":t=a;break;default:t=e}return t}();s.data=s.data.map((t,e,a)=>(t[n]=r(t[n],n,e,a),t))}),s}getMeta(t){if(this.meta||(this.meta=[]),this.meta[t])return this.meta[t].accessed=!0,this.meta[t]}setData(t,e,a=!0){this.meta=[],this.data=t,e||console.log(),e.forEach(t=>this.colAdd(t)),e.forEach(t=>this.findTypes(t)),this.castData()}findTypes(t){const e=this.getMeta(t),a=[];Object.keys(n.type).forEach(t=>{const e={type:n.type[t],count:0};a.push(e),a[n.type[t]]=e});for(let e of this.allRows(t)){const t=this.findType(e);null!==t&&a[t].count++}return a.sort(function(t,e){return"currency"===t.type&&t.count>0?-1:"currency"===e.type&&e.count>0?1:e.count-t.count}),e.types=a,a[0].type}findType(t){if(t&&""!==t){if(t instanceof Date)return n.type.date;if("number"==typeof t)return n.type.number;const e=""+t;if(""+parseFloat(e)===e)return n.type.number;if(e.startsWith("$")&&!isNaN(parseFloat(e.slice(1))))return n.type.currency;if(e.endsWith("%")&&!isNaN(parseFloat(e)))return n.type.percent;if(!isNaN(this.toDate(e).getTime()))return n.type.date;if(/^\$\d{0,2}((,\d\d\d)*)/g.test(t)&&!isNaN(parseFloat(t.trim().replace(/[^eE\+\-\.\d]/g,"").replace(/,/g,""))))return n.type.currency;switch(e.toLowerCase()){case"null":case"#ref!":break;default:if(t.length>0)return n.type.name}}return null}*allRows(t){const e=this.colNumber(t);for(let t=0;t<this.data.length;t++)yield this.data[t][e]}toDate(t,e=1970){let a,s=(a=t instanceof Date?t:new Date(t)).getFullYear();return s<100&&(s+=1900,a.setFullYear(s<e?s+100:s)),a}castVal(t,e){switch(t){case n.type.date:if(e instanceof Date)return e;e=this.toDate(e),isNaN(e.getTime())&&(e=null);break;case n.type.percent:if("string"==typeof e){const t=parseFloat(e);e=e.endsWith("%")?t/100:t}isNaN(e)&&(e=null);break;case n.type.currency:"string"==typeof e&&(e=e.replace(/[^eE\+\-\.\d]/g,""));case n.type.number:"string"==typeof e&&(e=parseFloat(e)),isNaN(e)&&(e=null);break;default:e=""+e}return e}}n.type={number:"number",name:"name",date:"date",currency:"currency",percent:"percent"},a.d(e,"Data",function(){return n})}}]);